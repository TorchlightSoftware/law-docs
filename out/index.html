<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta-->
    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Law | Law</title>
    <meta name="description" content="When your website appears in search results in say Google, the text here will be shown underneath your website's title.">
    <meta name="keywords" content="place, your, website, keywoards, here, keep, them, related, to, the, content, of, your, website">
    <meta name="author" content="Your Name"><meta name="generator" content="DocPad v6.60.3" />
    <meta name="viewport" content="width=device-width">
    <!-- Icons-->
    <link rel="shortcut icon" href="/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/ico/apple-touch-icon-57-precomposed.png">
    <!--[if lt IE 9]>
    <script async src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- Styles--><style >html.wait {
	cursor: wait !important;
	opacity: 0;
	transition: opacity 0.5s ease;
}</style><link  rel="stylesheet" href="/vendor/prettify.css" /><link  rel="stylesheet" href="/vendor/components-bootstrap/css/bootstrap.css" /><link  rel="stylesheet" href="/styles/style.css" />
  </head>
  <body>
    <!-- Markup-->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header"><a href="/" class="navbar-brand">Welcome</a></div>
        <ul class="nav navbar-nav">
          <li typeof="sioc:Page" about="/pages/api"><a href="/pages/api" property="dc:title">API</a></li>
          <li typeof="sioc:Page" about="/pages/about"><a href="/pages/about" property="dc:title">About</a></li>
          <li typeof="sioc:Page" about="/pages/examples"><a href="/pages/examples" property="dc:title">Examples</a></li>
          <li typeof="sioc:Page" about="/pages/example"><a href="/pages/example" property="dc:title">Example</a></li>
          <li typeof="sioc:Page" about="/pages/quickstart"><a href="/pages/quickstart" property="dc:title">Quickstart</a></li>
          <li typeof="sioc:Page" about="/pages/tutorials"><a href="/pages/tutorials" property="dc:title">Tutorials</a></li>
          <li typeof="sioc:Page" about="/pages/tutorial"><a href="/pages/tutorial" property="dc:title">Tutorial</a></li>
        </ul>
      </div>
    </nav>
    <div class="container">
      <section id="content" class="content">
<!-- Main hero unit for a primary marketing message or call to action.-->
<div class="jumbotron">
  <h1>Law</h1>
  <p><p>Law is a middleware layer for tying together:</p>
<ol>
<li>A set of services</li>
<li>Argument validations and lookups</li>
<li>An access control policy</li>
</ol>

  </p>
</div>
<!-- Example row of columns.-->
<div class="row">
  <div class="col-md-6">
    <h2>Domain-driven</h2>
    <p>Law lets you write an API in the language of your problem.</p>
    <p>Pull argument validation out of your services and into a "jargon" file.</p>
    <p><a href="https://github.com/TorchlightSoftware/law" class="btn btn-default">Visit Website</a></p>
  </div>
  <div class="col-md-6">
    <h2>Works with what you work with</h2>
    <p>Law services are just functions, and can be exposed via REST, websockets, or any other transport.</p>
    <p>Check out the Connect middleware for exposing your Law services via HTTP!</p>
    <p><a href="https://github.com/TorchlightSoftware/law-connect" class="btn btn-default">Law-Connect</a></p>
  </div>
</div>
<div class="something"><h1 id="law">Law</h1>
<h2 id="overview">Overview</h2>
<h3 id="use-case">Use Case</h3>
<p>You have a service-oriented architecture, implemented as a collection of related functions,
some interdependent, meant to collectively operate a shared domain of data types.</p>
<p>Law is a middleware layer for tying together:</p>
<ol>
<li>A set of services</li>
<li>Argument validations and lookups</li>
<li>An access control policy</li>
</ol>
<h3 id="value">Value</h3>
<p>Through this approach we accomplish the following:</p>
<ol>
<li>Decoupling between validations and domain logic</li>
<li>Access control is described in one place</li>
<li>The preconditions for services are declarative</li>
</ol>
<h2 id="rationale">Rationale</h2>
<h3 id="problems-live-in-domains">Problems live in domains</h3>
<p>We build applications to solve problems. These problems don&#39;t live in a vacuum.
They exist in <em>domains</em>, with their own concepts, rules, and processes.
When we write software, we often need to <em>model</em> and <em>simulate</em> these domains.
We do this so we can consistently extend, choreograph, and automate their processes.</p>
<p>These models are described via <em>computational</em> language, like JavaScript.
Our challenge in program and API design is then to make this computational model
faithful to the rules of the domain. Many strategies for doing this come from the
paradigm of object-orientation: we want to model postal service, so we create
<code>Mailman</code>, <code>Letter</code>, and <code>Address</code> classes with a <code>deliver(&lt;Letter&gt;, &lt;Address&gt;)</code> method.
However, the invariants and rules that define valid behavior for these data are
often dependent on runtime state, or easily scattered throughout a codebase.
If the validations logic is attached to the object implementation, it can be hard
to compose this logic with the broader application lifecycle.</p>
<h3 id="we-need-to-organize-our-machinery">We need to organize our machinery</h3>
<p>In solving problems, we build a lot of scaffolding and moving parts. We need to
do this in a way that is maintainable and extensible. The strategies for writing
a manageable codebase include decomposition, encapsulation, and separating concerns.
But these <em>engineering principles</em> are connected to implementation details, and can be at
odds with faithful representations of the problem domain we are working in. Real
problems often have cross-cutting concerns, which can be hard to maintainably <em>and</em> faithfully
represent.</p>
<h3 id="javascript-s-types-cannot-directly-encode-many-constraints">JavaScript&#39;s types cannot directly encode many constraints</h3>
<p>JavaScript&#39;s typing regime is incredibly flexible, but at a cost. Suppose we create
a constructor for a class representing an email address. This task might be more complex
than it sounds. Ultimately, what we want is a subset of all possible instances of
<code>String</code>. We can make instances of this class correct by construction by <em>validating</em>
the constructor arguments.</p>
<p>But, though methods on an object have at least self-knowledge, functions generally must
still must validate all of their explicit inputs. This can lead to a codebase whose
function bodies are littered with guards and validation calls. The problem is only
exacerbated when we attempt ad hoc polymorphism. Furthermore, we may have validations
which depend entirely upon runtime state. Such validations frequently end up as conditional
test-and-dispatch logic embedded in the cracks of a codebase.</p>
<p>Law is an effort to make our domain modeling readable, extensible, and semantic.</p>
<h2 id="architectural-role">Architectural Role</h2>
<p>Law is a middleware library for building web services. Its goal is to let you write composable
services that contain only business logic, with error handling and preconditions expressed
<em>declaratively</em> and enforced <em>outside of</em> a given service&#39;s definition.</p>
<p>In any service-oriented architecture in which you expose functions via an API, Law lets
you factor out preconditions into a declarative layer. Additionally, it lets you write
your services such that, at call time, the arguments satisfy arbitrary <em>runtime</em> validations,
not just <em>typing</em> validations. For example, you can ensure that a string argument representing
a session token is not only well-formed, but corresponds to an <em>active</em> session. The
correspondence precondition likely appears in many services.</p>
<p>Law gives you 3 concepts to use in structuring your application:</p>
<ol>
<li>Service definitions</li>
<li>Jargon</li>
<li>Policy</li>
</ol>
<p><em>Service definitions</em> are the functions that contain domain logic. They are meant to be small, testable,
and composable. They can share and reuse the same data concepts, transformations, and expectations.
The <em>Jargon</em> and <em>Policy</em> files let you pull the repetitious noise of assumption-validation <em>out</em>
of the service bodies and into a single description of a service&#39;s expectations.</p>
<p>The <em>Jargon</em> file is where you declare these shared data concepts. Different static and
runtime expectations can be written once, here, and referred to by services.</p>
<p>The <em>Policy</em> file is where broader preconditions (such as access control) can be declared.
This lets you record the assumptions of your services in one place, explicitly, and easily
modified as your application grows.</p>
<p>Wired together, these three objects provide an object mapping service names to &quot;smart&quot; functions,
which can be exposed through any mechanism you like--HTTP, RPC, the command line--any way
you can expose an API.</p>
<h2 id="inspiration-and-foundations">Inspiration and Foundations</h2>
<p>Our approach to policies was inspired by the filter lifecycle from Ruby on Rails.
The argument validations take some ideas from Design By Contract, e.g.
preconditions. Applying validators to default names was suggested by @JosephJNK.
I am interested to see if this will be conducive to creating a &#39;ubiquitous
language&#39; as described by Eric Evans in Domain Driven Design.</p>
<p>The separation of Express and Connect has influenced our decision to do the same.
I think that while frameworks can lead to gains in terms of productivity, a
library has greater potential for re-use.</p>
<p>Many thanks to @wearefractal (@amurray, @contra), @JosephJNK, and @uberscientist
for conversations and collaboration on application design with functional and
declarative programming.</p>

</div></section>
      <hr>
      <footer>
        <div>Â© TorchlightSoftware 2014</div>
        <div style="font-style:italic; font-size: 12px">This website was last updated at Wed Feb 05 2014 18:01:53 GMT-0700 (MST)</div>
      </footer>
    </div>
    <!-- Scripts--><script >(function(){
	/* Did we just livereload? */
var log = !!(localStorage && console && console.log && true);
if ( log && localStorage.getItem('/docpad-livereload/reloaded') === 'yes' ) {
	localStorage.removeItem('/docpad-livereload/reloaded');
	console.log('LiveReload completed at', new Date())
}

/* Listen for the regenerated event and perform a reload of the page when the event occurs */
var listen = function(){
	var primus = new Primus('/docpad-livereload');
	primus.on('data', function(data){
		if ( data && data.message ) {
			if ( data.message === 'generateBefore' ) {
				if ( log ) {
					console.log('LiveReload started at', new Date());
				}
				if ( typeof document.getElementsByTagName !== 'undefined' ) {
	document.getElementsByTagName('html')[0].className += ' wait';
}
			}
			else if ( data.message === 'generateAfter' ) {
				if ( log ) {
					localStorage.setItem('/docpad-livereload/reloaded', 'yes');
				}
				document.location.reload();
			}
		}
	});
};
	/* Inject socket into our page */
var inject = function(){
	var t = document.createElement('script');
	t.type = 'text/javascript';
	t.async = 'async';
	t.src = '/primus/primus.js';
	t.onload = listen;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(t, s);
};
	if ( typeof Primus !== 'undefined' ) {
		listen();
	} else {
		inject();
	}
})();</script><script defer="defer"  src="/vendor/prettify.js"></script><script defer="defer"  src="/vendor/jquery/jquery.js"></script><script defer="defer"  src="/vendor/components-bootstrap/js/bootstrap.js"></script><script defer="defer"  src="/vendor/log.js"></script><script defer="defer"  src="/vendor/modernizr.js"></script><script defer="defer"  src="/scripts/script.js"></script>
  </body>
</html>